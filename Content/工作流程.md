# CocoaPods工作流程

### CocoaPods工作流程
![2c5a3729f05e0ed26c16d83ae0ac13f0](media/14792883587567/2c5a3729f05e0ed26c16d83ae0ac13f0.png)

- 远程索引库：远程索引库里存放的是各种框架的描述信息，托管在 Github 上
- 本地索引库：在 install cocoapods 命令后，需要执行 pod setup 这个命令，pod setup 命令就是将远程索引库克隆到本地来，本地索引库的路径如下

```
~/.cocoapods/repos/master
```

- 本地索引文件 当执行 pod search 命令时，如果本地索引文件不存在，会创建这个文件。

```
pod search AFNetworking
Creating search index for spec repo 'master'..

索引路径：~/资源库/Caches/CocoaPods
```

### 制作CocoaPos库
#### 基本流程
首先在桌面新建一个 MXFileManager 目录，在该目录下新建一个 Classes 目录，用来存放框架源码，然后将 MXFileManager 托管到 Git。

- 托管框架源码到 Git

```
创建github仓库，生成demo项目
```
- 创建框架描述信息，在MXFileManager目录下创建Pod文件

```
pod spec create MXFileManager
```

编辑MXFileManager.podspec文件

```
kurokydeMacBook-Pro:MXFileManager kuroky$ pod trunk me
  - Name:     kurokyfan
  - Email:    kuro2007cumt@126.com
  - Since:    November 15th, 2016 04:16
  - Pods:
    - KKWKWebView
  - Sessions:
    - November 15th, 2016 04:16 -   March 23rd, 04:16. IP: 101.81.238.31
    Description: create CocoaPods
    - November 15th, 2016 04:19 -    April 8th, 03:21. IP: 101.81.238.31
    Description: create CocoaPods
    - June 23rd, 02:42          - October 29th, 02:46. IP:
    180.169.8.242
```
- 上传.podspec文件到 https://github.com/CocoaPods/Specs

1.注册trunk

```
pod trunk register kuro2007cumt@126.com 'kuroky' --verbose
```
2.点击邮件中的确认链接
3.查看注册结果

```
pod lib lint
```
4.检查.podspec文件的合法性

```
pod trunk push MXFileManager.podspec
```

```
Updating spec repo `master`

--------------------------------------------------------------------------------
 🎉  Congrats

 🚀  testLib (1.0.0) successfully published
 📅  October 17th, 00:38
 🌎  https://cocoapods.org/pods/MXFileManager
 👍  Tell your friends!
--------------------------------------------------------------------------------
```

此时你的 MXFileManager.podspec 就会 pull request 到远程索引库，CocoaPods 官方审核通过后，就可以出现在远程索引库中，当远程索引库收录后：

pod setup
这时你的本地索引库，会新加入 MXFileManager.podspec 这条记录，但是本地索引文件还未更新，因此删除掉以下路径的本地索引文件：

~/资源库/Caches/CocoaPods/search_index.json
执行 pod search MXFileManager 命令，当 search_index.json 文件重建完毕后，就可以在使用这个远程框架库了。

- 命令行 pod setup ， 创建本地索引库
- 命令行 pod install ，将框架集成到项目中


